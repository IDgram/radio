<html><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Radio en Ligne - Écoutez vos stations préférées</title>
    <meta name="description" content="Découvrez et écoutez une large sélection de stations de radio en ligne. Musique, actualités, et divertissement en direct 24/7.">
    <meta name="keywords" content="radio en ligne, stations de radio, streaming audio, musique en direct">
    <meta name="author" content="Votre Nom">
    
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="https://i.ibb.co/6v90HrY/favicon-afreeradio-blc.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://i.ibb.co/6v90HrY/favicon-afreeradio-blc.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://i.ibb.co/6v90HrY/favicon-afreeradio-blc.png">
    <link rel="manifest" href="https://i.ibb.co/6v90HrY/favicon-afreeradio-blc.png">
    <link rel="mask-icon" href="https://i.ibb.co/6v90HrY/favicon-afreeradio-blc.png" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
    
    <style>
    body, html {
        margin: 0;
        padding: 0;
        height: 100%;
        width: 100%;
        overflow: hidden;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        background-color: #000;
        color: #fff;
    }
    .container {
        max-width: 580px;
        margin: 0 auto;
        width: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: calc(100vh - 100px);
        padding: 20px;
        box-sizing: border-box;
        background-color: #000;
        padding-bottom: 120px;
        position: relative;
    }
    @media (max-width: 580px) {
        .container {
            max-width: 100%;
            padding-bottom: 120px;
        }
    }
    .aura {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 200px;
        height: 200px;
        border-radius: 50%;
        background: radial-gradient(circle, rgba(0,128,255,0.5) 0%, rgba(0,128,255,0) 70%);
        animation: pulse 4s ease-in-out infinite;
        pointer-events: none;
    }
    @keyframes pulse {
        0% {
            transform: translate(-50%, -50%) scale(1);
            opacity: 0.5;
        }
        50% {
            transform: translate(-50%, -50%) scale(1.2);
            opacity: 0.7;
        }
        100% {
            transform: translate(-50%, -50%) scale(1);
            opacity: 0.5;
        }
    }
    .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 100%;
    }
    .logo {
        width: 100px;
        object-fit: contain;
    }
    .live-indicator {
        background-color: #ff0000;
        color: #ffffff;
        padding: 5px 10px;
        border-radius: 15px;
        font-weight: bold;
        font-size: 14px;
    }
    .station-info {
        text-align: center;
        margin-top: 20px;
        align-items: center;
        display: flex;
        flex-direction: column;
    }
    .station-name {
        font-size: 24px;
        font-weight: bold;
        color: #fff;
        margin-bottom: 5px;
        display: flex;
        align-items: center;
    }
    .station-freq {
        font-size: 16px;
        font-weight: bold;
        color: #ffff00;
        margin-left: 10px;
    }
    .frequency {
        font-size: 72px;
        font-weight: bold;
        margin-top: 10px;
    }
    .tuner {
        position: relative;
        width: 100%;
        height: 300px;
        margin-top: 40px;
    }
    .controls {
        display: flex;
        justify-content: center;
        gap: 40px;
        margin-top: 40px;
        width: 100%;
    }
    .control-btn {
        background: none;
        border: none;
        color: #fff;
        cursor: pointer;
        padding: 10px;
        border-radius: 50%;
        transition: background-color 0.3s ease;
    }
    .control-btn:hover {
        background-color: rgba(255, 255, 255, 0.1);
    }
    .control-btn svg {
        width: 32px;
        height: 32px;
    }
    .stack-icon {
        width: 24px;
        height: 24px;
        cursor: pointer;
        object-fit: contain;
    }
    .station-list {
        display: none;
        padding: 20px 20px 120px 20px;
        position: fixed;
        top: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 100%;
        max-width: 580px;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.9);
        flex-direction: column;
        overflow: hidden;
        box-sizing: border-box;
        transition: opacity 0.3s ease-in-out;
        opacity: 0;
    }
    .station-list.show {
        opacity: 1;
    }
    @media (max-width: 580px) {
        .station-list {
            left: 0;
            transform: none;
        }
    }
    .station-list-container {
        height: calc(100% - 70px);
        padding-bottom: 70px;
        overflow-y: auto;
        scrollbar-width: none;
        -ms-overflow-style: none;
    }
    .station-list-container::-webkit-scrollbar {
        display: none;
    }
    .station-list-inner {
    }
    .station-item {
        background-color: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        margin-bottom: 10px;
        padding: 20px;
        display: grid;
        grid-template-columns: 70px 1fr auto;
        gap: 15px;
        align-items: center;
        border-radius: 15px;
        cursor: pointer;
        height: 90px;
        position: relative;
        transition: box-shadow 0.3s ease;
    }
    .station-item:hover {
        box-shadow: 0 5px 15px rgba(255, 255, 255, 0.2);
    }
    .station-info {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
    }
    .station-country {
        font-size: 14px;
        color: #ccc;
    }
    .station-genre {
        font-size: 14px;
        color: #ccc;
    }
    .play-button {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-color: rgba(255, 255, 255, 0.2);
        border: none;
        color: #fff;
        font-size: 18px;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }
    .play-button:hover {
        background-color: rgba(255, 255, 255, 0.3);
    }
    .active-station {
        background-color: rgba(255, 255, 255, 0.3);
    }
    .close-list {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background-color: #ff0000;
        color: #ffffff;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 24px;
        z-index: 1001;
        cursor: pointer;
    }
    .close-list:hover {
        background-color: #cc0000;
    }
    .tab-bar {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        width: 90%;
        max-width: 350px;
        height: 60px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 20px;
        padding: 0 10px;
    }
    @media (max-width: 580px) {
        .tab-bar {
            width: 95%;
            bottom: 10px;
        }
    }
    .station-logo {
        width: 70px;
        height: 70px;
        border-radius: 10px;
        object-fit: cover;
    }
    .volume-control {
        display: none;
    }
    .volume-slider {
        display: none;
    }
    .volume-slider::-webkit-slider-thumb {
        display: none;
    }
    .saved-stations-grid {
        display: none;
    }
    .saved-station-card {
        display: none;
    }
    .popup {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.5);
    }
    .popup-content {
        background-color: #000;
        color: #fff;
        margin: 15% auto;
        padding: 20px;
        border: 1px solid #888;
        width: 80%;
        max-width: 500px;
        max-height: 70vh;
        overflow: hidden;
    }
    #close-popup {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
    }
    #close-popup:hover,
    #close-popup:focus {
        color: #fff;
        text-decoration: none;
        cursor: pointer;
    }
    .playback-bar {
        position: fixed;
        bottom: 90px;
        left: 50%;
        transform: translateX(-50%);
        width: 90%;
        max-width: 350px;
        height: 60px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 20px;
        padding: 0 10px;
    }
    .current-station-logo {
        width: 50px;
        height: 50px;
        border-radius: 10px;
        object-fit: cover;
    }
    .playback-info {
        flex-grow: 1;
        margin-left: 10px;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }
    .current-station-name {
        font-size: 16px;
        font-weight: bold;
    }
    .current-frequency {
        font-size: 14px;
        color: #ffff00;
    }
    .favorite-btn {
        background: none;
        border: none;
        color: #fff;
        cursor: pointer;
        padding: 5px;
    }
    .favorite-btn svg {
        width: 24px;
        height: 24px;
    }
    .favorite-btn.active svg {
        fill: #ff0000;
    }
    .station-item.station-error {
        opacity: 0.5;
        pointer-events: none;
    }
</style>
<script src="google-sheets-api.js" defer></script>
</head>
<body>
<div class="container">
    <div class="header">
        <img src="https://i.ibb.co/hcYWX0H/logo-afreeradio.png" alt="Radio Logo" class="logo">
        <div class="live-indicator">
            <span>En direct</span>
        </div>
    </div>
    <div class="aura"></div>
    <div class="playback-bar">
        <img src="/path/to/current-station-logo.png" alt="Current Station Logo" class="current-station-logo">
        <div class="playback-info">
            <div class="current-station-name" id="current-station-name">KQED-FM</div>
            <div class="current-frequency" id="frequency-display">88.5</div>
        </div>
        <button class="favorite-btn" id="favorite-btn">
            <svg viewBox="0 0 24 24" width="24" height="24">
                <path fill="currentColor" d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
            </svg>
        </button>
    </div>
    <div class="station-info">
        <div class="station-name" id="current-station-name">KQED-FM</div>
        <div class="frequency" id="frequency-display">88.5</div>
    </div>
    <div class="tuner">
        <div class="dial">
        </div>
    </div>
</div>

<div class="tab-bar">
    <button class="control-btn" id="share-btn">
        <svg viewBox="0 0 24 24" width="32" height="32">
            <path fill="currentColor" d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"/>
        </svg>
    </button>
    <button class="control-btn" id="prev-btn">
        <svg viewBox="0 0 24 24" width="32" height="32">
            <path fill="currentColor" d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
        </svg>
    </button>
    <button class="control-btn" id="play-pause-btn">
        <svg viewBox="0 0 24 24" width="32" height="32">
            <path fill="currentColor" d="M8 5v14l11-7z"/>
        </svg>
    </button>
    <button class="control-btn" id="next-btn">
        <svg viewBox="0 0 24 24" width="32" height="32">
            <path fill="currentColor" d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
        </svg>
    </button>
    <button class="control-btn" id="radio-btn">
        <svg viewBox="0 0 24 24" width="24" height="24">
            <path fill="currentColor" d="M20 6H8.3l8.26-3.34L15.88 1 3.24 6.15C2.51 6.43 2 7.17 2 8v12c0 1.1.89 2 2 2h16c1.11 0 2-.9 2-2V8c0-1.11-.89-2-2-2zm0 2v3h-2V9h-2v2H4V8h16zM4 20v-7h16v7H4z"/>
        </svg>
    </button>
</div>

<div class="station-list" id="station-list">
    <div class="station-list-container">
        <div class="station-list-inner">
            <div class="station-item" data-freq="102.9" data-name="KBLX">
                <img src="/path/to/kblx-logo.png" alt="KBLX Logo" class="station-logo">
                <div class="station-info">
                    <span class="station-name">KBLX <span class="station-freq">102.9</span></span>
                    <span class="station-country"></span>
                    <span class="station-genre"></span>
                </div>
                <button class="play-button">▶</button>
                <audio src="https://example.com/fallback-stream.mp3"></audio>
            </div>
            <div class="station-item" data-freq="103.7" data-name="KKSF">
                <img src="/path/to/kksf-logo.png" alt="KKSF Logo" class="station-logo">
                <div class="station-info">
                    <span class="station-name">KKSF <span class="station-freq">103.7</span></span>
                    <span class="station-country"></span>
                    <span class="station-genre"></span>
                </div>
                <button class="play-button">▶</button>
                <audio src="https://example.com/fallback-stream.mp3"></audio>
            </div>
            <div class="station-item" data-freq="105.3" data-name="KITS">
                <img src="/path/to/kits-logo.png" alt="KITS Logo" class="station-logo">
                <div class="station-info">
                    <span class="station-name">KITS <span class="station-freq">105.3</span></span>
                    <span class="station-country"></span>
                    <span class="station-genre"></span>
                </div>
                <button class="play-button">▶</button>
                <audio src="https://example.com/fallback-stream.mp3"></audio>
            </div>
            <div class="station-item" data-freq="106.1" data-name="KMEL">
                <img src="/path/to/kmel-logo.png" alt="KMEL Logo" class="station-logo">
                <div class="station-info">
                    <span class="station-name">KMEL <span class="station-freq">106.1</span></span>
                    <span class="station-country"></span>
                    <span class="station-genre"></span>
                </div>
                <button class="play-button">▶</button>
                <audio src="https://example.com/fallback-stream.mp3"></audio>
            </div>
            <div class="station-item" data-freq="106.9" data-name="KFRC">
                <img src="/path/to/kfrc-logo.png" alt="KFRC Logo" class="station-logo">
                <div class="station-info">
                    <span class="station-name">KFRC <span class="station-freq">106.9</span></span>
                    <span class="station-country"></span>
                    <span class="station-genre"></span>
                </div>
                <button class="play-button">▶</button>
                <audio src="https://example.com/fallback-stream.mp3"></audio>
            </div>
            <div class="station-item" data-freq="88.5" data-name="KQED-FM">
                <img src="/path/to/kqed-fm-logo.png" alt="KQED-FM Logo" class="station-logo">
                <div class="station-info">
                    <span class="station-name">KQED-FM <span class="station-freq">88.5</span></span>
                    <span class="station-country"></span>
                    <span class="station-genre"></span>
                </div>
                <button class="play-button">▶</button>
                <audio src="https://example.com/fallback-stream.mp3"></audio>
            </div>
            <div class="station-item" data-freq="99.7" data-name="KMVQ-FM">
                <img src="/path/to/kmvq-fm-logo.png" alt="KMVQ-FM Logo" class="station-logo">
                <div class="station-info">
                    <span class="station-name">KMVQ-FM <span class="station-freq">99.7</span></span>
                    <span class="station-country"></span>
                    <span class="station-genre"></span>
                </div>
                <button class="play-button">▶</button>
                <audio src="https://example.com/fallback-stream.mp3"></audio>
            </div>
            <div class="station-item" data-freq="101.3" data-name="KIOI">
                <img src="/path/to/kioi-logo.png" alt="KIOI Logo" class="station-logo">
                <div class="station-info">
                    <span class="station-name">KIOI <span class="station-freq">101.3</span></span>
                    <span class="station-country"></span>
                    <span class="station-genre"></span>
                </div>
                <button class="play-button">▶</button>
                <audio src="https://example.com/fallback-stream.mp3"></audio>
            </div>
        </div>
    </div>
    <button class="close-list" id="close-list">✕</button>
</div>

<script>
    function safeQuerySelector(selector) {
        const element = document.querySelector(selector);
        if (!element) {
            console.warn(`Element with selector "${selector}" not found`);
        }
        return element;
    }

    function safeAddEventListener(element, event, handler) {
        if (element) {
            element.addEventListener(event, handler);
        } else {
            console.warn(`Cannot add event listener: element is null`);
        }
    }

    const SHEET_ID = '1xkd0EeZieoVautiYl3BI7OB7sG4orjYD_2czPSZLQ2M';
    const API_KEY = 'AIzaSyA1wqmdgawYs6myBAQLLpncEaSbPccsguI';
    const RANGE = 'radio_stations';
    let currentStationIndex = 0;
    let isPlaying = false;
    const audio = new Audio();

    function handleAudioError(error) {
        console.error('Audio playback error:', error);
        isPlaying = false;
        updatePlayPauseButton();
        alert('Failed to load the radio station. Please try another station.');
    }

    function updatePlaybackBar(stationName, frequency) {
        if (currentStationName) {
            currentStationName.textContent = stationName;
        }
        
        if (frequencyDisplay) {
            frequencyDisplay.textContent = frequency;
        }
    }

    async function fetchStations() {
        try {
            const response = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${RANGE}?key=${API_KEY}`);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            const data = await response.json();
            if (!data || !data.values) {
                throw new Error('No data received from Google Sheets API');
            }
            return data.values.slice(1).map(row => ({
                name: row[0] || '',
                country: row[1] || '',
                genre: row[2] || '',
                streamUrl: row[3] || '',
                frequency: row[4] || '',
                logo: row[5] || ''
            }));
        } catch (error) {
            console.error('Error fetching stations:', error);
            return [];
        }
    }

    async function updateStationList() {
        try {
            const stations = await fetchStations();
            if (stations.length === 0) {
                console.warn('No stations data available');
                return;
            }
            const stationListInner = document.querySelector('.station-list-inner');
            stationListInner.innerHTML = '';

            stations.forEach(station => {
                const stationItem = document.createElement('div');
                stationItem.className = 'station-item';
                stationItem.dataset.freq = station.frequency;
                stationItem.dataset.name = station.name;

                stationItem.innerHTML = `
                    <img src="${station.logo}" alt="${station.name} Logo" class="station-logo">
                    <div class="station-info">
                        <span class="station-name">${station.name} <span class="station-freq">${station.frequency}</span></span>
                        <span class="station-country">${station.country}</span>
                        <span class="station-genre">${station.genre}</span>
                    </div>
                    <button class="play-button">▶</button>
                    <audio src="${station.streamUrl}"></audio>
                `;

                stationListInner.appendChild(stationItem);
            });

            initializeStationItems();
        } catch (error) {
            console.error('Error updating station list:', error);
        }
    }

    setInterval(updateStationList, 5 * 60 * 1000);
    updateStationList();

    function getStationItems() {
        return document.querySelectorAll('.station-item');
    }

    function updateActiveStation(freq) {
        const stationItems = getStationItems();
        let foundStation = false;
        stationItems.forEach((item, index) => {
            const itemFreq = parseFloat(item.dataset.freq);
            if (Math.abs(itemFreq - freq) < 0.1) {
                item.classList.add('active-station');
                updatePlaybackBar(item.dataset.name, freq);
                foundStation = true;
                currentStationIndex = index;
            } else {
                item.classList.remove('active-station');
            }
        });
        if (!foundStation) {
            updatePlaybackBar(freq + " MHz", freq);
        }
    }

    function playPreviousStation() {
        const stationItems = getStationItems();
        currentStationIndex = (currentStationIndex - 1 + stationItems.length) % stationItems.length;
        playStation(stationItems[currentStationIndex]);
    }

    function playNextStation() {
        const stationItems = getStationItems();
        currentStationIndex = (currentStationIndex + 1) % stationItems.length;
        playStation(stationItems[currentStationIndex]);
    }

    function playStation(stationItem) {
        const freq = stationItem.dataset.freq;
        const name = stationItem.dataset.name;
        const streamUrl = stationItem.querySelector('audio').src;

        audio.src = streamUrl;
        audio.onerror = handleAudioError;

        audio.play().catch(error => {
            handleAudioError(error);
        });

        isPlaying = true;
        updatePlayPauseButton();
        updatePlaybackBar(name, freq);
        updateActiveStation(parseFloat(freq));
    }

    function togglePlayPause() {
        if (isPlaying) {
            audio.pause();
            isPlaying = false;
        } else {
            audio.play();
            isPlaying = true;
        }
        updatePlayPauseButton();
    }

    function updatePlayPauseButton() {
        const playPauseBtn = safeQuerySelector('#play-pause-btn');
        playPauseBtn.innerHTML = isPlaying
            ? '<svg viewBox="0 0 24 24" width="32" height="32"><path fill="currentColor" d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/></svg>'
            : '<svg viewBox="0 0 24 24" width="32" height="32"><path fill="currentColor" d="M8 5v14l11-7z"/></svg>';
    }

    const frequencyDisplay = safeQuerySelector('#frequency-display');
    const currentStationName = safeQuerySelector('#current-station-name');
    const stationList = safeQuerySelector('#station-list');
    const closeList = safeQuerySelector('#close-list');
    const shareBtn = safeQuerySelector('#share-btn');
    const prevBtn = safeQuerySelector('#prev-btn');
    const nextBtn = safeQuerySelector('#next-btn');
    const radioBtn = safeQuerySelector('#radio-btn');
    const favoriteBtn = safeQuerySelector('#favorite-btn');
    let isFavorite = false;

    function shareStation() {
        const currentStation = currentStationName ? currentStationName.textContent : '';
        const currentFrequency = frequencyDisplay ? frequencyDisplay.textContent : '';
        const shareText = `I'm listening to ${currentStation} (${currentFrequency}) on Radio Épurée!`;
        const shareUrl = encodeURIComponent(window.location.href);
        
        if (navigator.share) {
            navigator.share({
                title: 'Radio Épurée',
                text: shareText,
                url: window.location.href,
            }).then(() => {
                console.log('Successfully shared');
            }).catch((error) => {
                console.error('Error sharing:', error);
            });
        } else {
            window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${shareUrl}`, '_blank');
        }
    }

    safeAddEventListener(shareBtn, 'click', shareStation);
    safeAddEventListener(favoriteBtn, 'click', () => {
        isFavorite = !isFavorite;
        favoriteBtn.classList.toggle('active', isFavorite);

        const currentStation = currentStationName ? currentStationName.textContent : '';
        const currentFrequency = frequencyDisplay ? frequencyDisplay.textContent : '';

        if (isFavorite) {
            console.log(`Added ${currentStation} (${currentFrequency}) to favorites`);
        } else {
            console.log(`Removed ${currentStation} (${currentFrequency}) from favorites`);
        }
    });

    safeAddEventListener(prevBtn, 'click', playPreviousStation);
    safeAddEventListener(nextBtn, 'click', playNextStation);
    safeAddEventListener(safeQuerySelector('#play-pause-btn'), 'click', togglePlayPause);
    safeAddEventListener(radioBtn, 'click', () => {
        if (stationList) {
            stationList.style.display = 'flex';
            setTimeout(() => {
                stationList.classList.add('show');
            }, 10);
        }
    });

    function initializeStationItems() {
        const stationItems = getStationItems();
        stationItems.forEach((item) => {
            const playButton = item.querySelector('.play-button');
            if (playButton) {
                playButton.addEventListener('click', () => {
                    playStation(item);
                    if (stationList) {
                        stationList.classList.remove('show');
                        setTimeout(() => {
                            stationList.style.display = 'none';
                        }, 300);
                    }
                });
            }
            
            const audioElement = item.querySelector('audio');
            if (audioElement) {
                audioElement.onerror = () => {
                    console.error(`Failed to load audio for station: ${item.dataset.name}`);
                    item.classList.add('station-error');
                };
            }
        });
    }

    closeList.addEventListener('click', () => {
        if (stationList) {
            stationList.classList.remove('show');
            setTimeout(() => {
                stationList.style.display = 'none';
            }, 300);
        }
    });

    const aura = document.querySelector('.aura');

    function updateAura(event) {
        const x = event.clientX / window.innerWidth;
        const y = event.clientY / window.innerHeight;

        const hue = Math.floor((x + y) * 180);
        const size = 150 + Math.floor((x + y) * 100);

        aura.style.background = `radial-gradient(circle, hsla(${hue}, 100%, 50%, 0.5) 0%, hsla(${hue}, 100%, 50%, 0) 70%)`;
        aura.style.width = `${size}px`;
        aura.style.height = `${size}px`;
    }

    document.addEventListener('mousemove', updateAura);

    updateStationList().then(() => {
        initializeStationItems();
    });
</script>
</body></html>
